if(is.numeric(aed.trn[,i])){
ca <- skewness(aed.trn[,i])
print(ca)
}
}
# Coeficiente de Curtose
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
ck <- kurtosis(aed.trn[,i])
print(ck)
}
}
par(mfrow=c(1,2))
for(i in var.fct[-1]){
CrossTable(aed.trn$Survived,
aed.trn[,i],
prop.t = T,
chisq = T,
digits = 2,
dnn = c("Survived", i))
}
par(mfrow=c(1,2))
for(i in var.fct[-1]){
CrossTable(aed.trn$class,
aed.trn[,i],
prop.t = T,
chisq = T,
digits = 2,
dnn = c("class", i))
}
# Diagramas de Dispersão - Matriz de Correlação
plot(aed.trn[,c(var.num, var.num_con)])
# Tabela dos Coeficientes de Correlação
cor(aed.trn[,c(var.num, var.num_con)])
# missmap(etl.full)
# missmap(etl.full)
# missmap(etl.full)
missmap(etl.full)
par(mfrow=c(2,1))
# Distribuição de Frequências: Variáveis Quantitativas
for(i in var.num){
df <- fdt(aed.trn[,i])
#names(df)[[1]] = c(colnames(aed.trn[i]))
print(kable(df, caption = "Title of the table"))
}
# Diagramas de Dispersão - Matriz de Correlação
plot(aed.trn[,c(var.num, var.fct)])
# Tabela dos Coeficientes de Correlação
cor(aed.trn[,c(var.num, var.fct)])
# Gráfico dos Coeficientes de Correlação
cor.plot(aed.trn[,c(var.num, var.num_con)])
# Diagramas de Dispersão - Matriz de Correlação
plot(aed.trn[,c(var.num)])
# Diagramas de Dispersão - Matriz de Correlação
plot(aed.trn[,c(var.num)])
par(mfrow=c(2,1))
# Distribuição de Frequências: Variáveis Quantitativas
for(i in var.num){
df <- fdt(aed.trn[,i])
#names(df)[[1]] = c(colnames(aed.trn[i]))
print(kable(df, caption = "Title of the table"))
}
# Diagramas de Dispersão - Matriz de Correlação
plot(aed.trn[,var.num])
# Diagramas de Dispersão - Matriz de Correlação
plot(aed.trn[,c(var.num)])
# Diagramas de Dispersão - Matriz de Correlação
plot(aed.trn[])
# Tabela dos Coeficientes de Correlação
cor(aed.trn[])
# Tabela dos Coeficientes de Correlação
cor(aed.trn[var.num,)])
# Tabela dos Coeficientes de Correlação
cor(aed.trn[var.num,])
# Tabela dos Coeficientes de Correlação
cor(aed.trn[var.num])
# Tabela dos Coeficientes de Correlação
cor(aed.trn[var.num])
# Boxplots Idade conforme as Categóricas
par(mfrow=c(1,3), cex = 0.65)
for(i in var.fct){
boxplot(aed.trn$Age ~ aed.trn[,i], beside = TRUE, xlab = names(aed.trn)[grep(i, names(aed.trn))])
}
str(etl.full).col(:1) # Estrutura do dataset
str(etl.full).col(,2) # Estrutura do dataset
str(etl.full).col(2) # Estrutura do dataset
str(etl.full).col(dim = [:2]) # Estrutura do dataset
str(etl.full).col(dim = []) # Estrutura do dataset
str(etl.full).col(dim = [2]) # Estrutura do dataset
str(etl.full).col(dim = 2) # Estrutura do dataset
str(etl.full).col(dim = 1) # Estrutura do dataset
str(etl.full).col(dim = 3) # Estrutura do dataset
str(etl.full).col() # Estrutura do dataset
str(etl.full) # Estrutura do dataset
# Exporta
dput(z.trn, file = "datasets/z_trn.R")
# Boxplots Numéricas conforme as Survived
par(mfrow=c(2,2))
for(i in 0:length(aed.trn)){
if(is.numeric(aed.trn[,i])){
boxplot(aed.trn[,i] ~ Survived, ylab = names(aed.trn)[i], data = aed.trn)
}
}
# Boxplots Numéricas conforme as Survived
par(mfrow=c(2,2))
for(i in 0:length(aed.trn)){
if(is.numeric(aed.trn[,i])){
boxplot(aed.trn[,i] ~ class, ylab = names(aed.trn)[i], data = aed.trn)
}
}
# Boxplots Numéricas conforme as Survived
# par(mfrow=c(2,2))
for(i in 0:length(aed.trn)){
if(is.numeric(aed.trn[,i])){
boxplot(aed.trn[,i] ~ class, ylab = names(aed.trn)[i], data = aed.trn)
}
}
# Distribuição de Frequências para as Variáveis Qualitativas Nominais
for(i in var.fct){
fdt_cat(aed.trn[,i]) %>%
tibble() -> df
names(df)[1] = c(colnames(aed.trn[i]))
print(kable(df[order(df[2], decreasing = TRUE),]))
}
# Gráfico Histograma: Varáveis Quantitativas
#par(mfrow=c(1,2))
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
hist(aed.trn[,i],
main = paste("Histograma\n", names(aed.trn)[i]),
xlab = names(aed.trn)[i],
ylim = c(0, max(table(aed.trn[,"Age"]))*1.5),
labels = TRUE,
nclass = round(1+3.22*log10(nrow(as.array(aed.trn[,i])))) )
}
}
# Gráfico Histograma: Varáveis Quantitativas
par(mfrow=c(2,1))
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
hist(aed.trn[,i],
main = paste("Histograma\n", names(aed.trn)[i]),
xlab = names(aed.trn)[i],
ylim = c(0, max(table(aed.trn[,"Age"]))*1.5),
labels = TRUE,
nclass = round(1+3.22*log10(nrow(as.array(aed.trn[,i])))) )
}
}
# Gráfico Histograma: Varáveis Quantitativas
# par(mfrow=c(1,2))
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
hist(aed.trn[,i],
main = paste("Histograma\n", names(aed.trn)[i]),
xlab = names(aed.trn)[i],
ylim = c(0, max(table(aed.trn[,"Age"]))*1.8),
labels = TRUE,
nclass = round(1+3.22*log10(nrow(as.array(aed.trn[,i])))) )
}
}
# Gráfico Histograma: Varáveis Quantitativas
# par(mfrow=c(1,2))
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
hist(aed.trn[,i],
main = paste("Histograma\n", names(aed.trn)[i]),
xlab = names(aed.trn)[i],
ylim = c(0, max(table(aed.trn[,"Age"]))*2.5),
labels = TRUE,
nclass = round(1+3.22*log10(nrow(as.array(aed.trn[,i])))) )
}
}
# Gráfico Histograma: Varáveis Quantitativas
# par(mfrow=c(1,2))
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
hist(aed.trn[,i],
main = paste("Histograma\n", names(aed.trn)[i]),
xlab = names(aed.trn)[i],
#ylim = c(0, max(table(aed.trn[,"Age"]))*2.5),
labels = TRUE,
nclass = round(1+3.22*log10(nrow(as.array(aed.trn[,i])))) )
}
}
hist(aed.trn[aed.trn$class = 'Sim'])
hist(aed.trn[aed.trn$class %in% 'Sim'])
hist(aed.trn[aed.trn$class %in% Sim, ])
hist(aed.trn[aed.trn$class %in% sim, ])
hist(aed.trn[aed.trn$class %in% Positive, ])
hist(aed.trn[aed.trn$class %in% positive, ])
hist(aed.trn[aed.trn$class %in% 'positive', ])
par(mfrow=c(1,1))
# Gráfico de Dispersão Unidimensional: Variáveis Quantitativas
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
dotchart(aed.trn[,i], main = paste("Dispersão Unidimensional:", names(aed.trn)[i]))
}
}
hist(aed.trn[aed.trn$class %in% "Positive", ])
hist(aed.trn[aed.trn$class %in% "Positive"])
hist(aed.trn[aed.trn$class %in% "Positive" ,])
hist(aed.trn[aed.trn$class = "Positive" ,])
hist(aed.trn[aed.trn$class %in% "Positive" ,])
hist(aed.trn[aed.trn$class %in% 1 ,])
hist(aed.trn[aed.trn$class %in% Positive ])
hist(aed.trn[aed.trn$class %in% 1 ])
subset(aed.trn, class %in% Positive)
subset(aed.trn, class %in% "Positive"")
subset(aed.trn, class %in% "Positive")
subset(aed.trn, class %in% Positive)
subset(aed.trn, class %in% "Sim")
hist(subset(aed.trn, class %in% "Sim")['class'])
hist(subset(aed.trn, class %in% "Sim")[class])
#subset(aed.trn, class %in% "Sim")
hist(aed.trn[aed.trn$class %in% "Sim"]('class'))
#subset(aed.trn, class %in% "Sim")
hist(x = aed.trn$class,)
#subset(aed.trn, class %in% "Sim")
hist(,aed.trn$class)
plot(aed.trn$class)
table(aed.trn$class)
crosstable(aed.trn$class)
Crosstable(aed.trn$class)
CrossTable(aed.trn$class)
stargazer(aed.trn, median = T, mean.sd = T, iqr = T, type = "text", title = "Sumário Estatístico")
n = c()
m = c()
# Moda
for(i in 1:ncol(aed.trn)){
if(is.factor(aed.trn[,i])){
n = c(n, names(aed.trn)[i])
m = c(m, moda(aed.trn[,i]))
}
}
kable(data.frame("Variável" = n, "Moda" = m), align = "l")
# Quartis
# par(mfrow=c(2,2))
#df <- data.frame()
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
q <- data.frame(
quantile(aed.trn[,i])
)
names(q)[length(q)] <- names(aed.trn)[i]
print(q)
}
}
# Quintis
par(mfrow=c(2,2))
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
quintis = seq(.2, .8, .2)
q <- data.frame(quantile(aed.trn[,i], quintis))
names(q) <- names(aed.trn)[i]
print(q)
}
}
# Decis
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
decis = seq(.1, .9, .1)
q <- data.frame(quantile(aed.trn[,i], decis))
names(q) <- names(aed.trn)[i]
print(q)
}
}
# Percentis
par(mfrow=c(2,2))
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
percentis = seq(.01, .99, .01)
q <- data.frame(quantile(aed.trn[,i], percentis))
names(q) <- names(aed.trn)[i]
print(q)
}
}
# Boxplot
par(mfrow=c(2,2))
aed.trn$previsao = NULL
aed.trn$index = NULL
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
boxplot(summary(aed.trn[,i]),
ylab = names(aed.trn)[i],
main = paste("Boxplot", names(aed.trn)[i]))
}
}
# Boxplot
# par(mfrow=c(2,2))
aed.trn$previsao = NULL
aed.trn$index = NULL
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
boxplot(summary(aed.trn[,i]),
ylab = names(aed.trn)[i],
main = paste("Boxplot", names(aed.trn)[i]))
}
}
# Amplitude Total
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
amp <- diff(range(aed.trn[,i]))
print(amp)
}
}
# Variância
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
print(
var(aed.trn[,i])
)
}
}
# Desvio Padrão
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
print(
sd(aed.trn[,i])
)
}
}
# Coeficiente de Variação
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
cv <- 100*sd(aed.trn[,i]/mean(aed.trn[,i]))
print(cv)
}
}
par(mfrow=c(2,2))
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
datasim <- data.frame(aed.trn[,i])
g <- ggplot(datasim, aes(x = aed.trn[,i]), binwidth = 2) +
geom_histogram(aes(y = ..density..), fill = 'red', alpha = 0.5) +
geom_density(colour = 'blue') + xlab(expression(bold('Dados'))) +
ylab(expression(bold('Densidade')))
print(g)
}
}
#par(mfrow=c(2,2))
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
datasim <- data.frame(aed.trn[,i])
g <- ggplot(datasim, aes(x = aed.trn[,i]), binwidth = 2) +
geom_histogram(aes(y = ..density..), fill = 'red', alpha = 0.5) +
geom_density(colour = 'blue') + xlab(expression(bold('Dados'))) +
ylab(expression(bold('Densidade')))
print(g)
}
}
# Coeficiente de Assimetria (Skew)
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
ca <- skewness(aed.trn[,i])
print(ca)
}
}
# Coeficiente de Curtose
for(i in 1:ncol(aed.trn)){
if(is.numeric(aed.trn[,i])){
ck <- kurtosis(aed.trn[,i])
print(ck)
}
}
par(mfrow=c(1,2))
for(i in var.fct[-1]){
CrossTable(aed.trn$class,
aed.trn[,i],
prop.t = T,
chisq = T,
digits = 2,
dnn = c("class", i))
}
# Diagramas de Dispersão - Matriz de Correlação
plot(aed.trn[])
# Tabela dos Coeficientes de Correlação
cor(aed.trn[var.num])
# Gráfico dos Coeficientes de Correlação
cor.plot(aed.trn[,c(var.num, var.num_con)])
# Boxplots Idade conforme as Categóricas
par(mfrow=c(1,3), cex = 0.65)
for(i in var.fct){
boxplot(aed.trn$Age ~ aed.trn[,i], beside = TRUE, xlab = names(aed.trn)[grep(i, names(aed.trn))])
}
# Boxplots Numéricas conforme as Survived
# par(mfrow=c(2,2))
for(i in 0:length(aed.trn)){
if(is.numeric(aed.trn[,i])){
boxplot(aed.trn[,i] ~ class, ylab = names(aed.trn)[i], data = aed.trn)
}
}
dput(aed.trn, file = "datasets/aed_trn.R")
#massa <- z.trn
#mdl.tst <- z.tst
massa <- aed.trn
mdl.tst <- etl.tst
# Configurando uma semente para que o Gerador Aleatório de Números seja reproduzível.
set.seed(1618)
# Criando uma coluna com índices randômicos.
massa[ ,'index'] <- ifelse(runif(nrow(massa)) < 0.8, 1, 0)
# Criando os conjuntos de treino e de validação.
mdl.trn <- massa[massa$index == 1, ]
mdl.vld <- massa[massa$index == 0, ]
# Obtem o índice (posição), no vetor de nomes, onde corresponde ao valor 'index'.
col_idx <- grep('index', names(mdl.trn))
# Remove a coluna 'index' dos datasets, utilizando a posição obtida.
mdl.trn <- mdl.trn[ , -col_idx]
mdl.vld <- mdl.vld[ , -col_idx]
# Gerar Modelos de Classificação
ajt.trn <- glm(formula = class ~ .,
family = binomial(link = "logit"),
data = mdl.trn)
summary(ajt.trn)
pred <- predict( ajt.trn,
newdata = mdl.vld,
type = "response" )
# Criando um dataframe com os dados observados e os preditos.
previsoes <- data.frame(observado = mdl.vld$Survived,
previsto = pred %>%
round() %>%
factor(labels = c("Não", "Sim")))
pred <- predict( ajt.trn,
newdata = mdl.vld,
type = "response" )
# Criando um dataframe com os dados observados e os preditos.
previsoes <- data.frame(observado = mdl.vld$class,
previsto = pred %>%
round() %>%
factor(labels = c("Não", "Sim")))
CrossTable(previsoes$observado,
previsoes$previsto)
chisq.test(previsoes$observado,
previsoes$previsto)
hist(pred,
xlab = "Predições",
main = "Histograma de Predições")
cm <- confusionMatrix(previsoes$observado,
previsoes$previsto,
positive = "Sim")
pred <- predict( ajt.trn,
newdata = mdl.vld,
type = "response" )
# Criando um dataframe com os dados observados e os preditos.
previsoes <- data.frame(observado = mdl.vld$class,
previsto = pred %>%
round() %>%
factor(labels = c("Não", "Sim")))
CrossTable(previsoes$observado,
previsoes$previsto)
pred <- predict( ajt.trn,
newdata = mdl.vld,
type = "response" )
# Criando um dataframe com os dados observados e os preditos.
previsoes <- data.frame(observado = mdl.vld$class,
previsto = pred %>%
round() %>%
factor(labels = c("Sim", "Não")))
CrossTable(previsoes$observado,
previsoes$previsto)
chisq.test(previsoes$observado,
previsoes$previsto)
hist(pred,
xlab = "Predições",
main = "Histograma de Predições")
cm <- confusionMatrix(previsoes$observado,
previsoes$previsto,
positive = "Sim")
print(cm)
fourfoldplot(cm$table)
mosaicplot(cm$table, color = TRUE, shade = TRUE, main = "Mosaico para Confusion Matrix", )
acuracia <- (cm$table[1,1] + cm$table[2,2])/(cm$table[1,1] + cm$table[1,2] + cm$table[2,1] + cm$table[2,2])
# Precision
precisao <- cm$table[1,1] / (cm$table[1,1] + cm$table[1,2])
sensibilidade <- cm$table[1,1] / (cm$table[1,1] + cm$table[2,1])
f1 <- (2 * sensibilidade * precisao) / (sensibilidade + precisao)
metricas <- kable(
data.frame(
"Acuracia" = acuracia,
"Precisao" = precisao,
"Sensibilidade" = sensibilidade,
"F1-Score" = f1), format = "markdown", align = 'l')
metricas
class1 <- predict(ajt.trn, newdata = mdl.vld, type = "response")
class2 <- mdl.vld$Survived
pred <- prediction(class1, class2)
class1 <- predict(ajt.trn, newdata = mdl.vld, type = "response")
class2 <- mdl.vld$class
pred <- prediction(class1, class2)
perf <- performance(pred, "tpr", "fpr")
# Gerando uma curva ROC em R
plot(perf, col = rainbow(10, alpha = NULL))
chisq.test(previsoes$observado, previsoes$previsto)
predict(ajt.trn,
newdata = mdl.tst,
type = "response") %>%
round() %>%
factor(labels = c("Não", "Sim")) -> predicao
CrossTable(predicao, prop.t = T, digits = 2)
str(diabetes) # Estrutura do dataset
str(etl.full) # Estrutura do dataset
library("Amelia", lib.loc="C:/Users/ulp/anaconda3/envs/rstudio/lib/R/library")
detach("package:Amelia", unload=TRUE)
install.packages("Amelia")
library("Amelia", lib.loc="C:/Users/ulp/anaconda3/envs/rstudio/lib/R/library")
install.packages("Amelia")
missmap(etl.full)
Amelia(etl.full)
amelia(etl.full)
Amelia::(etl.full)
library("Amelia", lib.loc="C:/Users/ulp/anaconda3/envs/rstudio/lib/R/library")
detach("package:Amelia", unload=TRUE)
library("Amelia", lib.loc="C:/Users/ulp/anaconda3/envs/rstudio/lib/R/library")
